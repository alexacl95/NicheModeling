function [T, k] = bnm_clustering(T, opt)

    
    if nargin < 2
      
    end

    X = table2array(T(:,2:3));
    [~,~,D_temp] = spectralcluster(X,10,'Distance',"mahalanobis");
    
    n = floor(log(abs(D_temp))./log(10));
    INF = isinf(n);
    n(INF) = 0;
    k = find(n<=min(n)+DiffMag);

    k = length(k)+sum(INF);
    
    [ClusterIndex, ~, ~] = spectralcluster(X, k);
    
    T = addvars(T, ClusterIndex);
    
end